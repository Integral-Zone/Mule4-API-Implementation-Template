# Template Notes

The following template needs to be used as follows:

1. Rename:
- Mule Project from "mule4-api-implementation-template" to "<YOUR_API_NAME>". You will get this option when importing the project from anypoint exchange template.
- pom.xml:
	-- Project "<artifactId></artifactId>" to <YOUR_API_NAME> (e.g. system-my-cool-api)
	-- "<name></name>" to "<YOUR_DISPLAY_API_NAME>" (e.g. My Cool System API)
	-- Configure the SCM tags as needed
	-- project.groupId and project.properties.orgId to reflect your organization's Anypoint platform ID. 

2. Replace:
- src/main/mule/api-name-one-v1 with src/main/mule/<YOUR_API_NAME>-<VERSION>
- Mule config files in src/main/mule/<YOUR_API_NAME>-<VERSION> with :
    -- <YOUR_API_NAME>-router.xml
	-- <YOUR_API_NAME>-implementation.xml

3. Export RAML spec from Design Center OR update the RAML dependencies in pom.xml(Importing RAML as a zip from exchange). Please note that if you 
use RAML dependency to get API RAML from exchange, you will need to update orgID, API Name and version in apikit router in global.xml where this file is included. 
If you export RAML spec from Design Center, you will need to update the API Kit router settings to reflect
right path for the RAML(ideally src/main/resources/api/<YOUR_API_NAME>-<VERSION>)

4. Extract the contents of the exported RAML spec into src/main/resources/api/<YOUR_API_NAME>-<VERSION> folder(Do this step only if you are not inlcuding RAML as a dependency, manually downloadign RAML is not recommended)

5. Right click RAML spec > Mule > Generate Flows from REST API
   Note: If nothing gets created then most likely there is an issue with your RAML spec or Anypoint Studio, try checking both.

6. Remove "api-main" and "api-console" flows along with the API-KIT exception handler present in them. Now place the API resource flows in <YOUR_API_NAME>-router flow. After copying all the remaining flows, you can get rid of the autogenerated <YOUR_API_NAME>.xml file 

7. In the <environment>-properties.yaml update the value of api.id from API Manager or manage them outside of the template in case of an on prem deployment. In common-properties.yaml update api name and version

8. The implementation should happen on a separate configuration file (e.g. <YOUR_API_NAME>-<VERSION>/<YOUR_API_NAME>-implementation.xml) and referenced by the interface through flow-ref's

9. Note that the provided <YOUR_API_NAME>-<ROUTER>/<YOUR_API_NAME>-implementation.xml shows an example on the minimum logging any Mule implementation flow should have

10. If testing locally (Anypoint Studio) you need to pass the mule.env and encrypt.key as a JVM argument (e.g. -Dencrypt.key=somekey -Dmule.env=local).
This key shoUld be the key you will use to encrypt your sensitive properties, since no properties are currently encrypted, you can pass any value to this property.

11. Replace respective postman collections at src/test/resources/postman-collections/<YOUR_API_NAME>-<VERSION>.

12. Replace munit test cases folders at src/test/munit/<YOUR_API_NAME>-<VERSION>

